<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Tiger Status OBS</title>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>body { background: transparent; overflow: hidden; }</style>
</head>
<body>
    <div id="leaderboard" class="absolute top-10 right-10 w-96 flex flex-col gap-2"></div>
    <script>
        const socket = io('https://tiger-panel.onrender.com');

        socket.on('gameState', (data) => {
            if (data && data.teams) {
                const container = document.getElementById('leaderboard');
                const isTeamDead = (team) => team.players.every(p => p.status === 'Dead');
                
                const sorted = [...data.teams].sort((a, b) => {
                    const aDead = isTeamDead(a);
                    const bDead = isTeamDead(b);
                    if (aDead && !bDead) return 1;
                    if (!aDead && bDead) return -1;
                    return (b.totalTournamentScore + b.currentGameKills) - (a.totalTournamentScore + a.currentGameKills);
                });

                container.innerHTML = sorted.map((t, i) => {
                    const dead = isTeamDead(t);
                    return `
                        <div class="flex items-center border-r-[6px] h-14 transition-all duration-500 ${dead ? 'bg-slate-900/80 border-slate-700 opacity-50' : 'bg-slate-950/95 border-orange-500 shadow-xl'}">
                            <div class="w-12 h-full flex items-center justify-center font-black italic ${dead ? 'bg-slate-800 text-slate-500' : 'bg-orange-500 text-black'}">${i + 1}</div>
                            <div class="flex-1 px-4 flex justify-between items-center text-white font-black uppercase italic text-xl">
                                <span class="truncate w-40 text-right">${t.name}</span>
                                <span class="text-orange-400 font-mono">${t.totalTournamentScore + t.currentGameKills}</span>
                            </div>
                        </div>
                    `;
                }).join('');
            }
        });
    </script>
</body>
</html>